{% extends "base.html" %}

{% block title %}타로 운세 선택{% endblock %}

{% block head_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='choice.css') }}">
{% endblock %}

{% block content %}
    <div class="background-container">
        <div class="card-circle" id="cardCircle"></div>
        <div class="overlay"></div>
    </div>

    <main class="content">
        <h1 class="title">운명의 갈림길</h1>
        <div class="choice-container">
            <a href="{{ url_for('main.daily_fortune') }}" class="choice-card free-choice" title="무료 운세 보기">
                <div class="card-inner">
                    <h2>오늘의 운세</h2>
                    <p class="subtitle">FREE</p>
                    <p class="description">당신의 하루를 비춰줄<br>작은 등불을 확인하세요.</p>
                </div>
            </a>
            <a href="#" class="choice-card paid-choice" title="다른 운세 보기 (유료)">
                <div class="card-inner">
                    <h2>다른 운세 보기</h2>
                    <p class="subtitle">PREMIUM</p>
                    <p class="description">더 깊은 통찰과<br>미래의 조각들을 맞춰보세요.</p>
                </div>
            </a>
        </div>
    </main>
{% endblock %}

{% block body_js %}
    <script src="{{ url_for('static', filename='choice.js') }}"></script>
    <script>
        // 토스 결제 스크립트
        const clientKey = 'test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq'; // 본인 키 확인 필요
        const tossPayments = TossPayments(clientKey);
        const payBtn = document.querySelector('.paid-choice');

        if (payBtn) {
            payBtn.addEventListener('click', (e) => {
                e.preventDefault();
                // 결제창 호출
                tossPayments.requestPayment('카드', {
                    amount: 3000,
                    orderId: 'ORDER_' + new Date().getTime(),
                    orderName: '프리미엄 타로 운세',
                    customerName: '익명',
                    successUrl: window.location.origin + '/payment/success',
                    failUrl: window.location.origin + '/payment/fail',
                });
            });
        }
    </script>
{% endblock %}